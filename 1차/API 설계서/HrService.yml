openapi: "3.0.1"
info:
  title: "HR Service API"
  description: |
    인사 및 조직 관리 서비스(HR Service)를 위한 REST API 명세서입니다.<br>
    조직 구조, 직무/직책/직급 체계, 직원 프로필 및 발령 정보를 관리합니다.
  version: "1.0.0"
  contact:
    name: "Jehyun Kim"
servers:
  - url: "http://localhost:4300/api/v1/hr"
    description: "로컬 개발 서버"

tags:
  - name: "1. Organization Management"
    description: "조직(Tenant) 관리"
  - name: "2. Department Management"
    description: "부서 구조 관리"
  - name: "3. Job Management"
    description: "직무(Job) 기준 정보 관리"
  - name: "4. Position Management"
    description: "직책(Position) 기준 정보 관리"
  - name: "5. Grade Management"
    description: "직급(Grade) 기준 정보 관리"
  - name: "6. Employee Management"
    description: "직원 프로필 관리"
  - name: "7. Assignment Management"
    description: "인사 발령 및 이력 관리"

paths:
  # ==========================================
  # 1. Organization Management
  # ==========================================
  /organizations:
    get:
      tags: ["1. Organization Management"]
      summary: "조직(Tenant) 목록 조회"
      description: |
        시스템에 등록된 최상위 조직 목록을 조회합니다.<br>
        목록 조회 시 **사업자등록번호는 마스킹 처리**되어 반환됩니다.
      parameters:
        - name: "name"
          in: "query"
          description: "조직명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "code"
          in: "query"
          description: "조직 코드 검색 (일치)"
          schema:
            type: "string"
        - name: "businessRegistrationNumber"
          in: "query"
          description: "사업자등록번호 검색 (일치, 하이픈 포함/미포함)"
          schema:
            type: "string"
        - name: "description"
          in: "query"
          description: "조직 설명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: "정렬 기준 (예: name,asc)"
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/OrganizationSummary"
                  page:
                    $ref: "#/components/schemas/PageMetadata"

    post:
      tags: ["1. Organization Management"]
      summary: "조직 생성"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OrganizationRequest"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"

  /organizations/{id}:
    get:
      tags: ["1. Organization Management"]
      summary: "조직 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"
    put:
      tags: ["1. Organization Management"]
      summary: "조직 정보 수정"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OrganizationRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"
    delete:
      tags: ["1. Organization Management"]
      summary: "조직 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

  # ==========================================
  # 2. Department Management
  # ==========================================
  /departments:
    get:
      tags: ["2. Department Management"]
      summary: "부서 목록 조회 (계층형 트리 구조 지원)"
      description: |
        부서 목록을 조회합니다.<br>
        `parentDepartmentId`를 통해 계층 구조를 표현할 수 있습니다.
      parameters:
        - name: "organizationId"
          in: "query"
          description: "조직 ID 필터. 미입력 시 요청 사용자(토큰)의 소속 조직 데이터만 조회합니다. (시스템 관리자만 타 조직 조회 가능)"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "부서명 검색"
          schema:
            type: "string"
        - name: "code"
          in: "query"
          description: "부서 코드 검색"
          schema:
            type: "string"
        - name: "description"
          in: "query"
          description: "부서 설명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "parentDepartmentId"
          in: "query"
          description: "특정 상위 부서의 하위 부서만 조회"
          schema:
            type: "string"
            format: "uuid"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: "정렬 기준 (예: name,asc)"
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/Department"
                  page:
                    $ref: "#/components/schemas/PageMetadata"

    post:
      tags: ["2. Department Management"]
      summary: "부서 생성"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DepartmentRequest"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Department"

  /departments/{id}:
    get:
      tags: ["2. Department Management"]
      summary: "부서 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Department"
    put:
      tags: ["2. Department Management"]
      summary: "부서 정보 수정"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DepartmentRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Department"
    delete:
      tags: ["2. Department Management"]
      summary: "부서 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

  # ==========================================
  # 3. Job Management
  # ==========================================
  /jobs:
    get:
      tags: ["3. Job Management"]
      summary: "직무(Job) 목록 조회"
      description: "예: 개발, 영업, 인사 등 수행하는 업무의 종류"
      parameters:
        - name: "organizationId"
          in: "query"
          description: "조직 ID 필터. 미입력 시 요청 사용자(토큰)의 소속 조직 데이터만 조회합니다. (시스템 관리자만 타 조직 조회 가능)"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "직무명 검색"
          schema:
            type: "string"
        - name: "code"
          in: "query"
          description: "직무 코드 검색"
          schema:
            type: "string"
        - name: "description"
          in: "query"
          description: "직무 설명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: "정렬 기준 (예: name,asc)"
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/Job"
                  page:
                    $ref: "#/components/schemas/PageMetadata"
    post:
      tags: ["3. Job Management"]
      summary: "직무 생성"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/JobRequest"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Job"

  /jobs/{id}:
    get:
      tags: ["3. Job Management"]
      summary: "직무 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Job"
    put:
      tags: ["3. Job Management"]
      summary: "직무 수정"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/JobRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Job"
    delete:
      tags: ["3. Job Management"]
      summary: "직무 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

  # ==========================================
  # 4. Position Management
  # ==========================================
  /positions:
    get:
      tags: ["4. Position Management"]
      summary: "직책(Position) 목록 조회"
      description: "예: 팀장, 본부장, 파트장 등 맡은 역할"
      parameters:
        - name: "organizationId"
          in: "query"
          description: "조직 ID 필터. 미입력 시 요청 사용자(토큰)의 소속 조직 데이터만 조회합니다. (시스템 관리자만 타 조직 조회 가능)"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "직책명 검색"
          schema:
            type: "string"
        - name: "code"
          in: "query"
          description: "직책 코드 검색"
          schema:
            type: "string"
        - name: "description"
          in: "query"
          description: "직책 설명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: "정렬 기준 (예: name,asc)"
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/Position"
                  page:
                    $ref: "#/components/schemas/PageMetadata"
    post:
      tags: ["4. Position Management"]
      summary: "직책 생성"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PositionRequest"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Position"

  /positions/{id}:
    get:
      tags: ["4. Position Management"]
      summary: "직책 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Position"
    put:
      tags: ["4. Position Management"]
      summary: "직책 수정"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PositionRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Position"
    delete:
      tags: ["4. Position Management"]
      summary: "직책 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

  # ==========================================
  # 5. Grade Management
  # ==========================================
  /grades:
    get:
      tags: ["5. Grade Management"]
      summary: "직급(Grade) 목록 조회"
      description: "예: 사원, 대리, 과장 (서열 순서 포함)"
      parameters:
        - name: "organizationId"
          in: "query"
          description: "조직 ID 필터. 미입력 시 요청 사용자(토큰)의 소속 조직 데이터만 조회합니다. (시스템 관리자만 타 조직 조회 가능)"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "직급명 검색"
          schema:
            type: "string"
        - name: "code"
          in: "query"
          description: "직급 코드 검색"
          schema:
            type: "string"
        - name: "description"
          in: "query"
          description: "직급 설명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
        - name: "sort"
          in: "query"
          description: "정렬 기준 (예: step,asc)"
          schema:
            type: "array"
            items:
              type: "string"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/Grade"
                  page:
                    $ref: "#/components/schemas/PageMetadata"
    post:
      tags: ["5. Grade Management"]
      summary: "직급 생성"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GradeRequest"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Grade"

  /grades/{id}:
    get:
      tags: ["5. Grade Management"]
      summary: "직급 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Grade"
    put:
      tags: ["5. Grade Management"]
      summary: "직급 수정"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GradeRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Grade"
    delete:
      tags: ["5. Grade Management"]
      summary: "직급 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

  # ==========================================
  # 6. Employee Management
  # ==========================================
  /employees:
    get:
      tags: ["6. Employee Management"]
      summary: "직원(Employee) 목록 조회"
      description: |
        직원 목록을 조회합니다.<br>
        개인정보(이름, 이메일 등)는 DB에 암호화되어 저장되지만, 조회 시에는 복호화된 평문으로 반환됩니다.
      parameters:
        - name: "organizationId"
          in: "query"
          description: "조직 ID 필터. 미입력 시 요청 사용자(토큰)의 소속 조직 데이터만 조회합니다. (시스템 관리자만 타 조직 조회 가능)"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "이름 검색"
          schema:
            type: "string"
        - name: "employeeCode"
          in: "query"
          description: "사번 검색 (일치)"
          schema:
            type: "string"
        - name: "email"
          in: "query"
          description: "이메일 검색"
          schema:
            type: "string"
        - name: "departmentId"
          in: "query"
          description: "소속 부서 ID 필터"
          schema:
            type: "string"
            format: "uuid"
        - name: "jobId"
          in: "query"
          schema:
            type: "string"
            format: "uuid"
        - name: "positionId"
          in: "query"
          schema:
            type: "string"
            format: "uuid"
        - name: "gradeId"
          in: "query"
          schema:
            type: "string"
            format: "uuid"
        - name: "userId"
          in: "query"
          description: "시스템 사용자 ID 필터"
          schema:
            type: "string"
            format: "uuid"
        - name: "employmentType"
          in: "query"
          description: "고용 형태 (REGULAR, CONTRACT, DISPATCHED, PARTNER...)"
          schema:
            type: "string"
            enum: ["REGULAR", "CONTRACT", "DISPATCHED", "PARTNER", "INTERN", "FREELANCER"]
        - name: "partnerCompanyName"
          in: "query"
          description: "소속 협력사명 검색"
          schema:
            type: "string"
        - name: "phoneNumber"
          in: "query"
          description: "전화번호 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "joinDateStart"
          in: "query"
          description: "입사일 조회 시작 (YYYY-MM-DD)"
          schema:
            type: "string"
            format: "date"
        - name: "joinDateEnd"
          in: "query"
          description: "입사일 조회 종료 (YYYY-MM-DD)"
          schema:
            type: "string"
            format: "date"
        - name: "resignationDateStart"
          in: "query"
          description: "퇴사일 조회 시작 (YYYY-MM-DD)"
          schema:
            type: "string"
            format: "date"
        - name: "resignationDateEnd"
          in: "query"
          description: "퇴사일 조회 종료 (YYYY-MM-DD)"
          schema:
            type: "string"
            format: "date"
        - name: "gender"
          in: "query"
          description: "성별 필터"
          schema:
            type: "string"
            enum: ["M", "F", "OTHER"]
        - name: "nationality"
          in: "query"
          description: "국적 필터 (ISO 3166-1 alpha-2)"
          schema:
            type: "string"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: "정렬 기준 (예: name,asc)"
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/Employee"
                  page:
                    $ref: "#/components/schemas/PageMetadata"

    post:
      tags: ["6. Employee Management"]
      summary: "직원 등록"
      description: |
        새로운 직원을 등록합니다.<br>
        필수 정보인 이름, 사번 등과 함께 현재 소속(발령) 정보(`assignment`)를 입력받아 초기 발령 상태를 생성합니다.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmployeeRequest"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Employee"
        '409':
          description: "이미 존재하는 사번입니다."

  /employees/{id}:
    get:
      tags: ["6. Employee Management"]
      summary: "직원 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Employee"

    put:
      tags: ["6. Employee Management"]
      summary: "직원 정보 수정"
      description: |
        직원의 기본 프로필 정보를 수정합니다.<br>
        **주의:** 소속 부서나 직급 변경은 이 API가 아닌 **인사 발령(Assignment) API**를 사용해야 이력이 관리됩니다.
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmployeeUpdateRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Employee"

    delete:
      tags: ["6. Employee Management"]
      summary: "직원 삭제 (퇴사 처리)"
      description: |
        직원을 삭제(Soft Delete)합니다. 퇴사 처리와 동일한 효과를 가집니다.
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"
    
  # ==========================================
  # 7. Assignment Management (신규)
  # ==========================================
  /assignments:
    post:
      tags: ["7. Assignment Management"]
      summary: "인사 발령(소속 변경) 실행"
      description: |
        특정 직원의 소속 정보(부서, 직무, 직책, 직급)를 변경합니다.<br>
        발령이 실행되면 `EmployeeAssignment`가 업데이트되고, 이전 상태는 `EmployeeAssignmentHistory`에 기록됩니다.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AssignmentRequest"
      responses:
        '200':
          description: "발령 처리됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmployeeAssignment"

  /assignments/histories:
    get:
      tags: ["7. Assignment Management"]
      summary: "발령 이력 조회"
      description: "특정 직원의 과거 소속 변경 이력을 조회합니다."
      parameters:
        - name: "employeeId"
          in: "query"
          required: true
          schema:
            type: "string"
            format: "uuid"
        - name: "startDate"
          in: "query"
          description: "조회 시작일 (YYYY-MM-DD)"
          schema:
            type: "string"
            format: "date"
        - name: "endDate"
          in: "query"
          description: "조회 종료일 (YYYY-MM-DD)"
          schema:
            type: "string"
            format: "date"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: "정렬 기준 (예: createdAt,desc)"
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/AssignmentHistory"
                  page:
                    $ref: "#/components/schemas/PageMetadata"

components:
  schemas:
    PageMetadata:
      type: "object"
      properties:
        size:
          type: "integer"
          example: 20
        page:
          type: "integer"
          example: 0
        totalElements:
          type: "integer"
          example: 125
        totalPages:
          type: "integer"
          example: 7
        isLast:
          type: "boolean"
          example: false
        hasNext:
          type: "boolean"
          example: true

    DeleteResult:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "550e8400-e29b-41d4-a716-446655440000"
        isSoftDeleted:
          type: "boolean"
          example: true
        isHardDeleted:
          type: "boolean"
          example: false

    # --- HR Schemas ---
    OrganizationSummary:
      type: "object"
      description: "조직 목록 조회용 요약 정보 (민감정보 마스킹)"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
        name:
          type: "string"
          example: "삼성전자"
        code:
          type: "string"
          example: "SAMSUNG"
        businessRegistrationNumber:
          type: "string"
          description: "사업자등록번호 (마스킹됨: 123-45-*****)"
          example: "123-45-*****"
        description:
          type: "string"
          example: "본사 조직"
        timezone:
          type: "string"
          example: "Asia/Seoul"
        isActive:
          type: "boolean"
          example: true

    Organization:
      type: "object"
      description: "조직 상세 정보 (관리자용, 원본 데이터 포함)"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
        name:
          type: "string"
          example: "삼성전자"
        code:
          type: "string"
          example: "SAMSUNG"
        businessRegistrationNumber:
          type: "string"
          description: "사업자등록번호 (복호화된 원본)"
          example: "123-45-67890"
        description:
          type: "string"
          example: "본사 및 주요 사업장 포함"
        timezone:
          type: "string"
          example: "Asia/Seoul"
        externalSystemId:
          type: "string"
          description: "외부 시스템 조직 식별키 (예: SAP_ORG_ID)"
          example: "ORG_001_SAP"
        lastSyncAt:
          type: "string"
          format: "date-time"
          description: "마지막 동기화 일시"
          example: "2023-10-25T14:00:00Z"
        isSynced:
          type: "boolean"
          description: "외부 시스템과 연동된 데이터인지 여부"
          example: true
        isActive:
          type: "boolean"
          example: true
        createdAt:
          type: "string"
          format: "date-time"
          example: "2023-01-01T09:00:00Z"
        updatedAt:
          type: "string"
          format: "date-time"
          example: "2023-10-01T10:30:00Z"

    OrganizationRequest:
      type: "object"
      required: ["name"]
      properties:
        name:
          type: "string"
          example: "테크 스타트업"
        code:
          type: "string"
          example: "TECH_STARTUP"
        businessRegistrationNumber:
          type: "string"
          example: "111-22-33333"
        description:
          type: "string"
          example: "신규 설립 법인"
        timezone:
          type: "string"
          example: "Asia/Seoul"
        externalSystemId:
          type: "string"
          description: "외부 시스템 조직 식별키 (예: SAP_ORG_ID)"
          example: "EXT_ORG_999"

    Department:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "a1b2c3d4-e5f6-7890-1234-56789abcdef0"
        organizationId:
          type: "string"
          format: "uuid"
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
        parentDepartmentId:
          type: "string"
          format: "uuid"
          description: "상위 부서 ID"
          nullable: true
          example: "b2c3d4e5-f6a7-8901-2345-67890abcdef1"
        parentDepartmentName:
          type: "string"
          description: "[Read-Only] 상위 부서명"
          readOnly: true
          nullable: true
          example: "플랫폼 본부"
        name:
          type: "string"
          example: "백엔드 개발팀"
        code:
          type: "string"
          example: "DEPT-DEV-BE"
        description:
          type: "string"
          example: "서버 및 API 개발 담당"
        externalSystemId:
          type: "string"
          description: "외부 시스템 부서 식별키"
          example: "SAP_DEPT_1001"
        lastSyncAt:
          type: "string"
          format: "date-time"
          example: "2023-10-26T09:00:00Z"
        isSynced:
          type: "boolean"
          example: true
        isActive:
          type: "boolean"
          example: true
        createdAt:
          type: "string"
          format: "date-time"
          example: "2023-02-01T09:00:00Z"
        updatedAt:
          type: "string"
          format: "date-time"
          example: "2023-09-15T14:20:00Z"

    DepartmentRequest:
      type: "object"
      required: ["name"]
      properties:
        parentDepartmentId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "b2c3d4e5-f6a7-8901-2345-67890abcdef1"
        name:
          type: "string"
          example: "모바일 개발팀"
        code:
          type: "string"
          example: "DEPT-DEV-MO"
        description:
          type: "string"
          example: "iOS/Android 앱 개발"
        externalSystemId:
          type: "string"
          description: "외부 시스템 부서 식별키"
          example: "SAP_DEPT_1002"

    Job:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "c3d4e5f6-a7b8-9012-3456-7890abcdef12"
        organizationId:
          type: "string"
          format: "uuid"
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
        name:
          type: "string"
          example: "소프트웨어 개발"
        code:
          type: "string"
          example: "JOB_SW_DEV"
        description:
          type: "string"
          example: "SW 설계 및 구현"
        externalSystemId:
          type: "string"
          description: "외부 시스템 직무 식별키"
          example: "JOB_001"
        lastSyncAt:
          type: "string"
          format: "date-time"
          example: "2023-10-20T10:00:00Z"
        isSynced:
          type: "boolean"
          example: true
        isActive:
          type: "boolean"
          example: true

    JobRequest:
      type: "object"
      required: ["name"]
      properties:
        name:
          type: "string"
          example: "기획"
        code:
          type: "string"
          example: "JOB_PLANNING"
        description:
          type: "string"
          example: "서비스 기획 및 PM"
        externalSystemId:
          type: "string"
          description: "외부 시스템 직무 식별키"
          example: "JOB_002"

    Position:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "d4e5f6a7-b8c9-0123-4567-890abcdef123"
        organizationId:
          type: "string"
          format: "uuid"
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
        name:
          type: "string"
          example: "팀장"
        code:
          type: "string"
          example: "POS_TEAM_LEADER"
        description:
          type: "string"
          example: "조직 관리 및 리더십"
        externalSystemId:
          type: "string"
          description: "외부 시스템 직책 식별키"
          example: "POS_TL"
        lastSyncAt:
          type: "string"
          format: "date-time"
          example: "2023-10-20T10:00:00Z"
        isSynced:
          type: "boolean"
          example: true
        isActive:
          type: "boolean"
          example: true

    PositionRequest:
      type: "object"
      required: ["name"]
      properties:
        name:
          type: "string"
          example: "본부장"
        code:
          type: "string"
          example: "POS_HEAD"
        description:
          type: "string"
          example: "본부 총괄"
        externalSystemId:
          type: "string"
          description: "외부 시스템 직책 식별키"
          example: "POS_HD"

    Grade:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "e5f6a7b8-c9d0-1234-5678-90abcdef1234"
        organizationId:
          type: "string"
          format: "uuid"
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
        name:
          type: "string"
          example: "책임"
        code:
          type: "string"
          example: "GR_SENIOR"
        step:
          type: "integer"
          description: "직급 서열 (높을수록 상위 직급)"
          example: 3
        description:
          type: "string"
          example: "중간 관리자급"
        externalSystemId:
          type: "string"
          description: "외부 시스템 직급 식별키"
          example: "GR_03"
        lastSyncAt:
          type: "string"
          format: "date-time"
          example: "2023-10-20T10:00:00Z"
        isSynced:
          type: "boolean"
          example: true
        isActive:
          type: "boolean"
          example: true

    GradeRequest:
      type: "object"
      required: ["name", "step"]
      properties:
        name:
          type: "string"
          example: "수석"
        code:
          type: "string"
          example: "GR_PRINCIPAL"
        step:
          type: "integer"
          default: 0
          example: 4
        description:
          type: "string"
          example: "최상위 실무자"
        externalSystemId:
          type: "string"
          description: "외부 시스템 직급 식별키"
          example: "GR_04"

    # --- Employee & Assignment ---
    EmployeeAssignment:
      type: "object"
      description: "직원의 현재 발령(소속) 상태"
      properties:
        # ID 참조
        departmentId:
          type: "string"
          format: "uuid"
          example: "a1b2c3d4-e5f6-7890-1234-56789abcdef0"
        jobId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "c3d4e5f6-a7b8-9012-3456-7890abcdef12"
        positionId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "d4e5f6a7-b8c9-0123-4567-890abcdef123"
        gradeId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "e5f6a7b8-c9d0-1234-5678-90abcdef1234"
        
        # 상세 데이터
        employeeName:
          type: "string"
          example: "홍길동"
        employeeCode:
          type: "string"
          example: "20230001"
        appointmentType:
          type: "string"
          description: "발령 구분 (HIRE, PROMOTION, TRANSFER, DISPATCH...)"
          example: "TRANSFER"
        appointmentDate:
          type: "string"
          format: "date"
          description: "발령 일자"
          example: "2023-10-01"
        assignmentEndDate:
          type: "string"
          format: "date"
          description: "발령 종료 예정일"
          example: "2024-12-31"
        reason:
          type: "string"
          description: "발령 사유"
          example: "조직 개편에 따른 전배"
        
        # 스냅샷 데이터
        organizationCode:
          type: "string"
          example: "SAMSUNG"
        organizationName:
          type: "string"
          example: "삼성전자"
        departmentCode:
          type: "string"
          example: "DEPT-DEV-BE"
        departmentName:
          type: "string"
          example: "백엔드 개발팀"
        jobCode:
          type: "string"
          example: "JOB_SW_DEV"
        jobName:
          type: "string"
          example: "소프트웨어 개발"
        positionCode:
          type: "string"
          example: "POS_TEAM_LEADER"
        positionName:
          type: "string"
          example: "팀장"
        gradeCode:
          type: "string"
          example: "GR_SENIOR"
        gradeName:
          type: "string"
          example: "책임"
        
        isPrimary:
          type: "boolean"
          description: "주 직무 여부"
          example: true
        note:
          type: "string"
          description: "비고"
          example: "특채 입사"
        prevDepartmentName:
          type: "string"
          description: "이전 부서명"
          example: "모바일 개발팀"
        prevPositionName:
          type: "string"
          description: "이전 직책명"
          example: "파트장"

    Employee:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "12345678-1234-1234-1234-1234567890ab"
        organizationId:
          type: "string"
          format: "uuid"
          example: "f47ac10b-58cc-4372-a567-0e02b2c3d479"
        userId:
          type: "string"
          format: "uuid"
          description: "시스템 로그인 계정 ID (연동된 경우)"
          nullable: true
          example: "user-uuid-1234"
        
        # 필수 신상 정보
        employeeCode:
          type: "string"
          description: "사번"
          example: "20230001"
        employmentType:
          type: "string"
          description: "고용 형태 (REGULAR, CONTRACT, DISPATCHED, PARTNER...)"
          enum: ["REGULAR", "CONTRACT", "DISPATCHED", "PARTNER", "INTERN", "FREELANCER"]
          example: "REGULAR"
        name:
          type: "string"
          example: "홍길동"
        privacyAgreementAt:
          type: "string"
          format: "date-time"
          description: "개인정보 수집 동의 일시"
          example: "2023-01-01T09:00:00Z"
        privacyPolicyVersion:
          type: "string"
          description: "개인정보 처리방침 버전"
          example: "v1.0"

        # 선택 신상 정보
        partnerCompanyName:
          type: "string"
          description: "소속 협력사명"
          example: "파트너사(주)"
        englishName:
          type: "string"
          example: "Hong Gil-dong"
        profileImageUrl:
          type: "string"
          example: "https://s3.ap-northeast-2.amazonaws.com/profile/20230001.jpg"
        email:
          type: "string"
          format: "email"
          description: "사내 이메일"
          example: "hong@company.com"
        personalEmail:
          type: "string"
          format: "email"
          description: "개인 이메일 (마스킹됨: hon***@gmail.com)"
          example: "hon***@gmail.com"
        phoneNumber:
          type: "string"
          description: "전화번호 (마스킹됨: 010-1234-****)"
          example: "010-1234-****"
        residentRegistrationNumber:
          type: "string"
          description: "주민등록번호 (마스킹됨: 900101-1******)"
          example: "900101-1******"
        socialSecurityNumber:
          type: "string"
          description: "해외 식별 번호 (SSN) (마스킹됨)"
          example: "***-**-****"
        passportNumber:
          type: "string"
          description: "여권 번호 (마스킹됨)"
          example: "M123****"
        joinDate:
          type: "string"
          format: "date"
          example: "2023-01-01"
        resignationDate:
          type: "string"
          format: "date"
          example: "2024-12-31"
        contractStartDate:
          type: "string"
          format: "date"
          example: "2023-01-01"
        contractEndDate:
          type: "string"
          format: "date"
          example: "2023-12-31"
        signatureImageUrl:
          type: "string"
          example: "https://s3.../sign.png"
        birthDate:
          type: "string"
          format: "date"
          example: "1990-01-01"
        gender:
          type: "string"
          enum: ["M", "F", "OTHER"]
          example: "M"
        nationality:
          type: "string"
          description: "ISO 3166-1 alpha-2"
          example: "KR"
        militaryStatus:
          type: "string"
          example: "군필"
        zipCode:
          type: "string"
          example: "13529"
        address:
          type: "string"
          example: "경기도 성남시 분당구 판교역로"
        detailAddress:
          type: "string"
          example: "A동 101호"
        emergencyContact:
          type: "string"
          example: "010-9876-5432"
        carNumber:
          type: "string"
          example: "12가3456"
        bankAccount:
          type: "object"
          description: "급여 계좌 정보 (계좌번호 마스킹)"
          example: {"bank": "Shinhan", "accountNumber": "110-***-******"}

        # 현재 소속 정보 (Flat하게 제공하거나 객체로 제공 가능, 여기서는 객체로 포함)
        currentAssignment:
          $ref: "#/components/schemas/EmployeeAssignment"

        externalSystemId:
          type: "string"
          description: "외부 시스템 직원 식별키"
          example: "EMP_SAP_20230001"
        lastSyncAt:
          type: "string"
          format: "date-time"
          example: "2023-10-26T15:00:00Z"
        isSynced:
          type: "boolean"
          example: true
        isActive:
          type: "boolean"
          example: true
        createdAt:
          type: "string"
          format: "date-time"
          example: "2023-01-01T09:00:00Z"
        updatedAt:
          type: "string"
          format: "date-time"
          example: "2023-10-01T10:00:00Z"

    EmployeeRequest:
      type: "object"
      required: ["employeeCode", "employmentType", "name", "departmentId", "privacyAgreementAt", "privacyPolicyVersion"]
      description: "직원 생성 요청 (기본 프로필 + 초기 발령 정보)"
      properties:
        # 기본 프로필
        employeeCode:
          type: "string"
          example: "20230002"
        employmentType:
          type: "string"
          enum: ["REGULAR", "CONTRACT", "DISPATCHED", "PARTNER", "INTERN", "FREELANCER"]
          example: "REGULAR"
        name:
          type: "string"
          example: "김철수"
        privacyAgreementAt:
          type: "string"
          format: "date-time"
          example: "2023-11-01T09:00:00Z"
        privacyPolicyVersion:
          type: "string"
          example: "v1.0"
        
        # 선택 프로필
        partnerCompanyName:
          type: "string"
        englishName:
          type: "string"
          example: "Kim Cheol-su"
        email:
          type: "string"
          format: "email"
          example: "cheolsu@company.com"
        personalEmail:
          type: "string"
          format: "email"
          example: "cheolsu.p@gmail.com"
        phoneNumber:
          type: "string"
          example: "010-5678-1234"
        residentRegistrationNumber:
          type: "string"
          example: "920101-1111111"
        socialSecurityNumber:
          type: "string"
          example: "900-12-3456"
        passportNumber:
          type: "string"
          example: "N1234567"
        joinDate:
          type: "string"
          format: "date"
          example: "2023-11-01"
        contractStartDate:
          type: "string"
          format: "date"
        contractEndDate:
          type: "string"
          format: "date"
        birthDate:
          type: "string"
          format: "date"
          example: "1992-01-01"
        gender:
          type: "string"
          enum: ["M", "F", "OTHER"]
          example: "M"
        nationality:
          type: "string"
          example: "KR"
        militaryStatus:
          type: "string"
          example: "군필"
        zipCode:
          type: "string"
          example: "06234"
        address:
          type: "string"
          example: "서울시 강남구 테헤란로"
        detailAddress:
          type: "string"
          example: "B동 202호"
        emergencyContact:
          type: "string"
          example: "010-1111-2222"
        carNumber:
          type: "string"
          example: "34나5678"
        bankAccount:
          type: "object"
          example: {"bank": "KakaoBank", "accountNumber": "3333-12-345678"}
        
        userId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "user-uuid-5678"
        externalSystemId:
          type: "string"
          description: "외부 시스템 직원 식별키"
          example: "EMP_SAP_20230002"
        
        # 초기 발령 정보 (필수)
        departmentId:
          type: "string"
          format: "uuid"
          description: "초기 배정 부서 ID"
          example: "a1b2c3d4-e5f6-7890-1234-56789abcdef0"
        jobId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "c3d4e5f6-a7b8-9012-3456-7890abcdef12"
        positionId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "d4e5f6a7-b8c9-0123-4567-890abcdef123"
        gradeId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "e5f6a7b8-c9d0-1234-5678-90abcdef1234"
        
        # 초기 발령 상세
        appointmentType:
          type: "string"
          default: "HIRE"
          example: "HIRE"
        appointmentDate:
          type: "string"
          format: "date"
          example: "2023-11-01"
        reason:
          type: "string"
          description: "입사/발령 사유"
          example: "신규 입사"

    EmployeeUpdateRequest:
      type: "object"
      description: "직원 프로필 수정 요청 (소속 변경 제외)"
      properties:
        name:
          type: "string"
          example: "김철수"
        englishName:
          type: "string"
          example: "Kim Cheol-su"
        email:
          type: "string"
          format: "email"
          example: "cheolsu.new@company.com"
        personalEmail:
          type: "string"
          format: "email"
          example: "cheolsu.p@gmail.com"
        phoneNumber:
          type: "string"
          example: "010-9999-8888"
        birthDate:
          type: "string"
          format: "date"
          example: "1992-01-01"
        gender:
          type: "string"
          enum: ["M", "F", "OTHER"]
          example: "M"
        nationality:
          type: "string"
          example: "KR"
        zipCode:
          type: "string"
          example: "06234"
        address:
          type: "string"
          example: "서울시 강남구 테헤란로"
        detailAddress:
          type: "string"
          example: "B동 202호"
        emergencyContact:
          type: "string"
          example: "010-1111-2222"
        carNumber:
          type: "string"
          example: "34나5678"
        bankAccount:
          type: "object"
          example: {"bank": "KakaoBank", "accountNumber": "3333-**-*******"}
        
        userId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "user-uuid-5678"
        isActive:
          type: "boolean"
          example: true
          
    # --- Assignment Management Schemas ---
    AssignmentRequest:
      type: "object"
      required: ["employeeId", "departmentId", "appointmentType", "appointmentDate", "reason"]
      description: "발령 요청 객체"
      properties:
        employeeId:
          type: "string"
          format: "uuid"
          example: "12345678-1234-1234-1234-1234567890ab"
        departmentId:
          type: "string"
          format: "uuid"
          example: "b2c3d4e5-f6a7-8901-2345-67890abcdef1"
        jobId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "c3d4e5f6-a7b8-9012-3456-7890abcdef12"
        positionId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "d4e5f6a7-b8c9-0123-4567-890abcdef123"
        gradeId:
          type: "string"
          format: "uuid"
          nullable: true
          example: "e5f6a7b8-c9d0-1234-5678-90abcdef1234"
        
        appointmentType:
          type: "string"
          description: "발령 구분"
          example: "PROMOTION"
        appointmentDate:
          type: "string"
          format: "date"
          description: "발령 일자"
          example: "2024-01-01"
        assignmentEndDate:
          type: "string"
          format: "date"
          example: "2025-12-31"
        reason:
          type: "string"
          description: "발령 사유 상세"
          example: "정기 승진"
        note:
          type: "string"
          description: "비고"
          example: "우수 사원 특진"
        isPrimary:
          type: "boolean"
          default: true
          example: true
    
    AssignmentHistory:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
          example: "hist-uuid-1111"
        employeeName:
          type: "string"
          example: "홍길동"
        employeeCode:
          type: "string"
          example: "20230001"
        appointmentType:
          type: "string"
          example: "TRANSFER"
        appointmentNumber:
          type: "string"
          example: "HR-2023-005"
        appointmentDate:
          type: "string"
          format: "date"
          example: "2023-10-01"
        assignmentStartDate:
          type: "string"
          format: "date"
          example: "2023-10-01"
        assignmentEndDate:
          type: "string"
          format: "date"
          example: "2023-12-31"
        
        snapshotOrganizationCode:
          type: "string"
          example: "SAMSUNG"
        snapshotOrganizationName:
          type: "string"
          example: "삼성전자"
        snapshotDepartmentCode:
          type: "string"
          example: "DEPT-DEV-BE"
        snapshotDepartmentName:
          type: "string"
          example: "백엔드 개발팀"
        snapshotJobCode:
          type: "string"
          example: "JOB_SW_DEV"
        snapshotJobName:
          type: "string"
          example: "소프트웨어 개발"
        snapshotPositionCode:
          type: "string"
          example: "POS_MEMBER"
        snapshotPositionName:
          type: "string"
          example: "팀원"
        snapshotGradeCode:
          type: "string"
          example: "GR_JUNIOR"
        snapshotGradeName:
          type: "string"
          example: "선임"
        
        reason:
          type: "string"
          example: "부서 이동"
        approvers:
          type: "array"
          items:
            type: "object"
            description: "승인자 목록 스냅샷"
            example: {"name":"이승인", "employeeCode":"2010001", "positionName":"팀장", "approvedAt":"2023-09-28"}
        
        createdAt:
          type: "string"
          format: "date-time"
          description: "이력 생성 일시"
          example: "2023-10-01T09:00:00Z"