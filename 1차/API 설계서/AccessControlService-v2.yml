openapi: "3.0.1"
info:
  title: "Access Control Service API"
  description: |
    출입 제어 서비스(Access Control Service)를 위한 REST API 명세서입니다.<br>
    PostgreSQL 스키마를 기반으로 작성되었습니다.<br>
    모든 필드명은 카멜케이스(camelCase)를 사용합니다.
  version: "1.0.0"
  contact:
    name: "Jehyun Kim"
servers:
  - url: "http://localhost:4300/api"
    description: "로컬 개발 서버"     

tags:
  - name: "1. Time Policies"
    description: "시간 정책 (스케쥴 및 공휴일) 관리"
  - name: "2. Security Levels"
    description: "보안 등급 및 임계값 관리"
  - name: "3. Access Point Management"
    description: "출입 포인트 관리 (출입 포인트(출입문/게이트) 및 출입 포인트 그룹)"
  - name: "4. Access Rules"
    description: "출입 규칙(Where + When) 정의"

  - name: "3. Personnels"
    description: "출입 주체(직원/방문객) 관리"
  - name: "4. Authentication"
    description: "인증 규칙 및 수단(Credential) 관리"
  - name: "8. Access Grants"
    description: "권한 부여 및 이력"
  - name: "10. Interlocks"
    description: "인터락(Man-trap) 연동 제어"

paths:
  # ==========================================
  # 1. Time Policies
  # ==========================================
  /time-schedules:
    get:
      tags: ["1. Time Policies"]
      summary: "시간 스케쥴 목록 조회"
      description: |
        조건에 맞는 시간 스케쥴 목록을 조회합니다.<br>
        모든 요일(7개)과 정의된 공휴일 타입에 대한 상세 설정이 포함되어 반환됩니다.<br>
        공휴일 슬롯(예: HOL1...)에는 매핑된 공휴일의 상세 정보(이름, 날짜 목록 등)가 포함됩니다.<br>
        페이지네이션, 정렬 및 다양한 필터링(이름, 코드, 설명, 활성화 여부)을 지원합니다.
      parameters:
        - name: "organizationId"
          in: "query"
          description: "조직 ID 필터"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "시간 스케쥴 이름 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "description"
          in: "query"
          description: "시간 스케쥴 설명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "code"
          in: "query"
          description: "시간 스케쥴 코드 검색 (일치)"
          schema:
            type: "string"
        - name: "isActive"
          in: "query"
          description: "활성화 여부 필터 (true: 활성, false: 비활성, 미입력: 전체)"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          description: "페이지 번호 (0부터 시작). 값을 입력하지 않으면 기본값(0)이 적용됩니다."
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          description: |
            페이지 당 항목 수. 값을 입력하지 않으면 기본값(1000)이 적용됩니다.<br>
            (주의: 데이터가 많을 경우, 한 번에 너무 많은 항목을 조회하면 응답 속도가 느려질 수 있습니다.)
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: |
            정렬 기준 (형식: 필드명,정렬방향)<br>
            예: createdAt,desc (최신순), name,asc (이름순)<br>
            다중 정렬 가능
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeScheduleListResponse"
              examples:
                fullExample:
                  summary: "다양한 스케쥴 유형 및 공휴일 매핑 포함 예시"
                  value:
                    content:
                      - organizationId: "123e4567-e89b-12d3-a456-426614174000"
                        id: "123e4567-e89b-12d3-a456-426614174001"
                        name: "평일 근무시간 (커스텀)"
                        description: "평일 09:00 ~ 12:00, 13:00 ~ 18:00 근무"
                        code: "SCH-001"
                        details:
                          - dayOfWeek: "MON"
                            type: "CUSTOM"
                            timeSlots:
                              - startTime: "09:00:00"
                                endTime: "12:00:00"
                              - startTime: "13:00:00"
                                endTime: "18:00:00"
                          - dayOfWeek: "TUE"
                            type: "CUSTOM"
                            timeSlots:
                              - startTime: "09:00:00"
                                endTime: "12:00:00"
                              - startTime: "13:00:00"
                                endTime: "18:00:00"
                          - dayOfWeek: "WED"
                            type: "CUSTOM"
                            timeSlots:
                              - startTime: "09:00:00"
                                endTime: "12:00:00"
                              - startTime: "13:00:00"
                                endTime: "18:00:00"
                          - dayOfWeek: "THU"
                            type: "CUSTOM"
                            timeSlots:
                              - startTime: "09:00:00"
                                endTime: "12:00:00"
                              - startTime: "13:00:00"
                                endTime: "18:00:00"
                          - dayOfWeek: "FRI"
                            type: "CUSTOM"
                            timeSlots:
                              - startTime: "09:00:00"
                                endTime: "12:00:00"
                              - startTime: "13:00:00"
                                endTime: "18:00:00"
                          - dayOfWeek: "SAT"
                            type: "ALWAYS_DENIED"
                            timeSlots: []
                          - dayOfWeek: "SUN"
                            type: "ALWAYS_DENIED"
                            timeSlots: []
                          - dayOfWeek: "HOL1"
                            type: "ALWAYS_DENIED"
                            holiday:
                              id: "holiday-uuid-1"
                              name: "신정"
                              dates: ["2024-01-01"]
                            timeSlots: []
                          - dayOfWeek: "HOL2"
                            type: "ALWAYS_DENIED"
                            holiday:
                              id: "holiday-uuid-2"
                              name: "설날 연휴"
                              dates: ["2024-02-09", "2024-02-10", "2024-02-11", "2024-02-12"]
                            timeSlots: []
                          - dayOfWeek: "HOL3"
                            type: "ALWAYS_DENIED"
                            holiday:
                              id: "holiday-uuid-3"
                              name: "삼일절"
                              dates: ["2024-03-01"]
                            timeSlots: []
                        isActive: true
                        createdAt: "2024-01-01T09:00:00Z"
                        updatedAt: "2024-01-01T09:00:00Z"
                    page:
                      size: 20
                      page: 0
                      totalElements: 1
                      totalPages: 1
                      isLast: true
                      hasNext: false

    post:
      tags: ["1. Time Policies"]
      summary: "시간 스케쥴 생성"
      description: |
        새로운 시간 스케쥴을 생성합니다.<br>
        생성 시 반드시 모든 요일(MON~SUN)에 대한 설정이 포함되어야 하며, 필요한 공휴일 타입(HOL...)을 추가로 설정할 수 있습니다.<br>
        공휴일 타입의 경우, 사전에 등록된 공휴일 ID(id)를 매핑하여 등록할 수 있습니다.<br>
        
        **유니크 제약 조건:**<br>
        - `name`: 조직(`organizationId`) 내에서 유일해야 합니다.<br>
        - `code`: 조직(`organizationId`) 내에서 유일해야 합니다.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TimeScheduleRequest"
            examples:
              createScheduleExample:
                summary: "평일 근무(09-18) 및 공휴일 휴무 설정 입력 예시"
                value:
                  organizationId: "123e4567-e89b-12d3-a456-426614174000"
                  name: "일반 평일 근무"
                  description: "월~금 09:00~18:00 근무 (점심시간 12:00~13:00 제외), 주말 및 공휴일 출입 불가"
                  code: "SCH-REGULAR-01"
                  details:
                    - dayOfWeek: "MON"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:00:00"
                          endTime: "12:00:00"
                        - startTime: "13:00:00"
                          endTime: "18:00:00"
                    - dayOfWeek: "TUE"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:00:00"
                          endTime: "12:00:00"
                        - startTime: "13:00:00"
                          endTime: "18:00:00"
                    - dayOfWeek: "WED"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:00:00"
                          endTime: "12:00:00"
                        - startTime: "13:00:00"
                          endTime: "18:00:00"
                    - dayOfWeek: "THU"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:00:00"
                          endTime: "12:00:00"
                        - startTime: "13:00:00"
                          endTime: "18:00:00"
                    - dayOfWeek: "FRI"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:00:00"
                          endTime: "12:00:00"
                        - startTime: "13:00:00"
                          endTime: "18:00:00"
                    - dayOfWeek: "SAT"
                      type: "ALWAYS_DENIED"
                      timeSlots: []
                    - dayOfWeek: "SUN"
                      type: "ALWAYS_DENIED"
                      timeSlots: []
                    - dayOfWeek: "HOL1"
                      type: "ALWAYS_DENIED"
                      timeSlots: []
                      holidayId: "holiday-uuid-152"
                    - dayOfWeek: "HOL2"
                      type: "ALWAYS_ALLOWED"
                      timeSlots: []
                      holidayId: "holiday-uuid-221"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeSchedule"
              examples:
                createdResponse:
                  summary: "생성된 시간 스케쥴 응답"
                  value:
                    organizationId: "123e4567-e89b-12d3-a456-426614174000"
                    id: "123e4567-e89b-12d3-a456-426614174001"
                    name: "일반 평일 근무"
                    description: "월~금 09:00~18:00 근무 (점심시간 12:00~13:00 제외), 주말 및 공휴일 출입 불가"
                    code: "SCH-REGULAR-01"
                    details:
                      - dayOfWeek: "MON"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "TUE"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "WED"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "THU"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "FRI"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "SAT"
                        type: "ALWAYS_DENIED"
                        timeSlots: []
                      - dayOfWeek: "SUN"
                        type: "ALWAYS_DENIED"
                        timeSlots: []
                      - dayOfWeek: "HOL1"
                        type: "ALWAYS_DENIED"
                        holiday:
                          id: "holiday-uuid-152"
                          name: "신정"
                          dates: ["2024-01-01"]
                        timeSlots: []
                    isActive: true
                    createdAt: "2024-01-01T09:00:00Z"
                    updatedAt: "2024-01-01T09:00:00Z"
        '409':
          description: "Conflict. 데이터 유니크 제약 조건 위반 (이름, 코드 중복)"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  errorCode:
                    type: "string"
                    example: "DUPLICATE_ENTRY"
                  errorMessage:
                    type: "string"
                    example: "이미 존재하는 스케쥴 이름 또는 코드입니다."

  /time-schedules/{id}:
    get:
      tags: ["1. Time Policies"]
      summary: "시간 스케쥴 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeSchedule"
              examples:
                singleSchedule:
                  summary: "단일 스케쥴 조회 응답"
                  value:
                    organizationId: "123e4567-e89b-12d3-a456-426614174000"
                    id: "123e4567-e89b-12d3-a456-426614174001"
                    name: "일반 평일 근무"
                    description: "월~금 09:00~18:00 근무 (점심시간 12:00~13:00 제외), 주말 및 공휴일 출입 불가"
                    code: "SCH-REGULAR-01"
                    details:
                      - dayOfWeek: "MON"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "TUE"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "WED"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "THU"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "FRI"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:00:00"
                            endTime: "12:00:00"
                          - startTime: "13:00:00"
                            endTime: "18:00:00"
                      - dayOfWeek: "SAT"
                        type: "ALWAYS_DENIED"
                        timeSlots: []
                      - dayOfWeek: "SUN"
                        type: "ALWAYS_DENIED"
                        timeSlots: []
                      - dayOfWeek: "HOL1"
                        type: "ALWAYS_DENIED"
                        holiday:
                          id: "holiday-uuid-1"
                          name: "신정"
                          dates: ["2024-01-01"]
                        timeSlots: []
                    isActive: true
                    createdAt: "2024-01-01T09:00:00Z"
                    updatedAt: "2024-01-01T09:00:00Z"
    put:
      tags: ["1. Time Policies"]
      summary: "시간 스케쥴 수정"
      description: |
        시간 스케쥴 정보를 전체 수정합니다 (Replacement).
        
        **주의사항:**
        - 기존 데이터를 요청 본문(Body)의 데이터로 **완전히 덮어씁니다.**
        - 따라서 `details` 리스트에 포함되지 않은 기존 설정(예: 기존에 존재하던 HOL4 설정 등)은 **삭제**됩니다.
        - 수정 시 유지하려는 모든 요일과 공휴일 설정을 포함해서 보내야 합니다.
        
        **유니크 제약 조건:**
        - `name`: 조직(`organizationId`) 내에서 유일해야 합니다. (자기 자신 제외)
        - `code`: 조직(`organizationId`) 내에서 유일해야 합니다. (자기 자신 제외)
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TimeScheduleRequest"
            examples:
              updateExample:
                summary: "시간 스케쥴 전체 수정 요청 예시"
                value:
                  organizationId: "123e4567-e89b-12d3-a456-426614174000"
                  name: "일반 평일 근무 (수정됨)"
                  description: "설명이 변경되었습니다. (09:30 출근)"
                  code: "SCH-REGULAR-01"
                  isActive: true
                  details:
                    - dayOfWeek: "MON"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:30:00"
                          endTime: "18:30:00"
                    - dayOfWeek: "TUE"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:30:00"
                          endTime: "18:30:00"
                    - dayOfWeek: "WED"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:30:00"
                          endTime: "18:30:00"
                    - dayOfWeek: "THU"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:30:00"
                          endTime: "18:30:00"
                    - dayOfWeek: "FRI"
                      type: "CUSTOM"
                      timeSlots:
                        - startTime: "09:30:00"
                          endTime: "18:30:00"
                    - dayOfWeek: "SAT"
                      type: "ALWAYS_DENIED"
                      timeSlots: []
                    - dayOfWeek: "SUN"
                      type: "ALWAYS_DENIED"
                      timeSlots: []
                    - dayOfWeek: "HOL1"
                      type: "ALWAYS_DENIED"
                      timeSlots: []
                      holidayId: "holiday-uuid-152"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeSchedule"
              examples:
                updatedResponse:
                  summary: "수정된 시간 스케쥴 응답"
                  value:
                    organizationId: "123e4567-e89b-12d3-a456-426614174000"
                    id: "123e4567-e89b-12d3-a456-426614174001"
                    name: "일반 평일 근무 (수정됨)"
                    description: "설명이 변경되었습니다. (09:30 출근)"
                    code: "SCH-REGULAR-01"
                    details:
                      - dayOfWeek: "MON"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:30:00"
                            endTime: "18:30:00"
                      - dayOfWeek: "TUE"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:30:00"
                            endTime: "18:30:00"
                      - dayOfWeek: "WED"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:30:00"
                            endTime: "18:30:00"
                      - dayOfWeek: "THU"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:30:00"
                            endTime: "18:30:00"
                      - dayOfWeek: "FRI"
                        type: "CUSTOM"
                        timeSlots:
                          - startTime: "09:30:00"
                            endTime: "18:30:00"
                      - dayOfWeek: "SAT"
                        type: "ALWAYS_DENIED"
                        timeSlots: []
                      - dayOfWeek: "SUN"
                        type: "ALWAYS_DENIED"
                        timeSlots: []
                      - dayOfWeek: "HOL1"
                        type: "ALWAYS_DENIED"
                        holiday:
                          id: "holiday-uuid-152"
                          name: "신정"
                          dates: ["2024-01-01"]
                        timeSlots: []
                    isActive: true
                    createdAt: "2024-01-01T09:00:00Z"
                    updatedAt: "2024-01-10T15:00:00Z"
        '409':
          description: "Conflict. 데이터 유니크 제약 조건 위반 (이름, 코드 중복)"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  errorCode:
                    type: "string"
                    example: "DUPLICATE_ENTRY"
                  errorMessage:
                    type: "string"
                    example: "이미 존재하는 스케쥴 이름 또는 코드입니다."
    delete:
      tags: ["1. Time Policies"]
      summary: "시간 스케쥴 삭제"
      description: |
        시간 스케쥴을 삭제합니다.
        서버 정책에 따라 논리적 삭제(Soft Delete) 또는 물리적 삭제(Hard Delete)가 수행될 수 있으며, 결과에 해당 정보가 포함됩니다.
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"
              examples:
                softDeleteExample:
                  summary: "논리적 삭제(Soft Delete) 결과 예시"
                  value:
                    id: "123e4567-e89b-12d3-a456-426614174000"
                    isSoftDeleted: true
                    isHardDeleted: false

  /holidays:
    get:
      tags: ["1. Time Policies"]
      summary: "공휴일 목록 조회"
      description: |
        조건에 맞는 공휴일 목록을 조회합니다.
        페이지네이션, 정렬 및 다양한 필터링(이름, 코드, 설명, 반복 여부 등)을 지원합니다.
        
        **참고:** `isRecurring`이 `true`인 공휴일의 경우, 서버 설정(예: 현재 연도 전후 1년)에 따라 자동으로 계산된 연도가 포함된 날짜 목록(`items`)이 반환됩니다.
      parameters:
        - name: "organizationId"
          in: "query"
          description: "조직 ID 필터"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "공휴일 이름 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "description"
          in: "query"
          description: "공휴일 설명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "code"
          in: "query"
          description: "공휴일 코드 검색 (일치)"
          schema:
            type: "string"
        - name: "isRecurring"
          in: "query"
          description: "매년 반복 여부 필터"
          schema:
            type: "boolean"
        - name: "isActive"
          in: "query"
          description: "활성화 여부 필터 (true: 활성, false: 비활성, 미입력: 전체)"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          description: "페이지 번호 (0부터 시작). 값을 입력하지 않으면 기본값(0)이 적용됩니다."
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          description: |
            페이지 당 항목 수.
            값을 입력하지 않으면 기본값(1000)이 적용됩니다.
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: |
            정렬 기준 (형식: 필드명,정렬방향)
            예: holidayDate,asc (날짜순), name,asc (이름순)
            다중 정렬 가능
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HolidayListResponse"
              examples:
                holidayListExample:
                  summary: "공휴일 목록 조회 결과 예시"
                  value:
                    content:
                      - id: "holiday-uuid-1"
                        organizationId: "123e4567-e89b-12d3-a456-426614174000"
                        name: "신정 (매년 반복)"
                        description: "매년 1월 1일"
                        code: "HOL-001"
                        isRecurring: true
                        items:
                          - id: "item-gen-1"
                            holidayDate: "2025-01-01"
                            isSubstitute: false
                        isActive: true
                      - id: "holiday-uuid-2"
                        organizationId: "123e4567-e89b-12d3-a456-426614174000"
                        name: "2024년 설날 연휴"
                        description: "2024년 설날 및 대체공휴일"
                        code: "HOL-2024-SEOL"
                        isRecurring: false
                        items:
                          - id: "item-uuid-3"
                            holidayDate: "2024-02-09"
                            isSubstitute: false
                          - id: "item-uuid-4"
                            holidayDate: "2024-02-10"
                            isSubstitute: false
                          - id: "item-uuid-5"
                            holidayDate: "2024-02-11"
                            isSubstitute: false
                          - id: "item-uuid-6"
                            holidayDate: "2024-02-12"
                            isSubstitute: true
                        isActive: true
                    page:
                      size: 20
                      page: 0
                      totalElements: 2
                      totalPages: 1
                      isLast: true
                      hasNext: false
    post:
      tags: ["1. Time Policies"]
      summary: "공휴일 등록"
      description: |
        새로운 공휴일 그룹을 등록합니다.
        
        **날짜 입력 규칙:**
        - `isRecurring: true` (매년 반복): `holidayDate`에 **"MM-DD"** 형식 입력 (예: "01-01")
        - `isRecurring: false` (단발성): `holidayDate`에 **"YYYY-MM-DD"** 형식 입력 (예: "2024-02-10")
        
        **유니크 제약 조건:**
        - `name`: 조직(`organizationId`) 내에서 유일해야 합니다.
        - `code`: 조직(`organizationId`) 내에서 유일해야 합니다.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/HolidayRequest"
            examples:
              recurringHoliday:
                summary: "매년 반복되는 공휴일(신정) 등록 예시"
                value:
                  organizationId: "123e4567-e89b-12d3-a456-426614174000"
                  name: "신정"
                  description: "매년 1월 1일은 신정입니다."
                  code: "HOL-001"
                  isRecurring: true
                  isActive: true
                  items:
                    - holidayDate: "01-01"
                      isSubstitute: false
              oneTimeHoliday:
                summary: "특정 연도 공휴일(설날) 등록 예시"
                value:
                  organizationId: "123e4567-e89b-12d3-a456-426614174000"
                  name: "2024년 설날"
                  description: "2024년 갑진년 설날 연휴"
                  code: "HOL-2024-SEOL"
                  isRecurring: false
                  isActive: true
                  items:
                    - holidayDate: "2024-02-09"
                    - holidayDate: "2024-02-10"
                    - holidayDate: "2024-02-11"
                    - holidayDate: "2024-02-12"
                      isSubstitute: true
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Holiday"
              examples:
                createdResponse:
                  summary: "생성된 공휴일 응답"
                  value:
                    id: "holiday-uuid-1"
                    organizationId: "123e4567-e89b-12d3-a456-426614174000"
                    name: "신정"
                    description: "매년 1월 1일은 신정입니다."
                    code: "HOL-001"
                    isRecurring: true
                    items:
                      - id: "item-gen-1"
                        holidayDate: "2024-01-01"
                        isSubstitute: false
                      - id: "item-gen-2"
                        holidayDate: "2025-01-01"
                        isSubstitute: false
                    isActive: true
        '409':
          description: "Conflict. 데이터 유니크 제약 조건 위반 (이름, 코드 중복)"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  errorCode:
                    type: "string"
                    example: "DUPLICATE_ENTRY"
                  errorMessage:
                    type: "string"
                    example: "이미 존재하는 공휴일 이름/코드가 있습니다."

  /holidays/{id}:
    get:
      tags: ["1. Time Policies"]
      summary: "공휴일 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Holiday"
              examples:
                singleHoliday:
                  summary: "단건 조회 예시"
                  value:
                    organizationId: "123e4567-e89b-12d3-a456-426614174000"  
                    id: "holiday-uuid-1"                    
                    name: "신정"
                    description: "매년 1월 1일"
                    code: "HOL-001"
                    isRecurring: true
                    isActive: true
                    items:
                      - id: "item-gen-1"
                        holidayDate: "2024-01-01"
                        isSubstitute: false
    put:
      tags: ["1. Time Policies"]
      summary: "공휴일 수정"
      description: |
        공휴일 정보를 전체 수정합니다 (Replacement).
        
        **주의사항:**
        - 기존 데이터를 요청 본문(Body)의 데이터로 **완전히 덮어씁니다.**
        - `items` 리스트도 새로 전달된 목록으로 교체됩니다.
        
        **날짜 입력 규칙 (isRecurring 변경 시 주의):**
        - `isRecurring`을 `true`로 설정/변경 시: `holidayDate`는 **"MM-DD"** 형식이어야 합니다.
        - `isRecurring`을 `false`로 설정/변경 시: `holidayDate`는 **"YYYY-MM-DD"** 형식이어야 합니다.
        
        **유니크 제약 조건:**
        - `name`: 조직(`organizationId`) 내에서 유일해야 합니다. (자기 자신 제외)
        - `code`: 조직(`organizationId`) 내에서 유일해야 합니다. (자기 자신 제외)
        - `items.holidayDate`: 조직(`organizationId`) 내에서 유일해야 합니다. 이미 다른 공휴일 그룹에 등록된 날짜는 지정할 수 없습니다.
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/HolidayRequest"
            examples:
              updateExample:
                summary: "공휴일 수정 요청 예시"
                value:
                  organizationId: "123e4567-e89b-12d3-a456-426614174000"
                  name: "신정 (수정됨)"
                  description: "설명 변경됨"
                  code: "HOL-001"
                  isRecurring: true
                  isActive: true
                  items:
                    - holidayDate: "01-01"
                      isSubstitute: false
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Holiday"
              examples:
                updatedResponse:
                  summary: "수정된 공휴일 응답"
                  value:
                    id: "holiday-uuid-1"
                    organizationId: "123e4567-e89b-12d3-a456-426614174000"
                    name: "신정 (수정됨)"
                    description: "설명 변경됨"
                    code: "HOL-001"
                    isRecurring: true
                    items:
                      - id: "item-gen-2"
                        holidayDate: "2025-01-01"
                        isSubstitute: false
                    isActive: true
        '409':
          description: "Conflict. 데이터 유니크 제약 조건 위반 (이름, 코드, 날짜 중복)"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  errorCode:
                    type: "string"
                    example: "DUPLICATE_ENTRY"
                  errorMessage:
                    type: "string"
                    example: "이미 존재하는 공휴일 이름/코드 또는 겹치는 날짜가 있습니다."
    delete:
      tags: ["1. Time Policies"]
      summary: "공휴일 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"
              examples:
                deleteResponse:
                  summary: "공휴일 삭제 결과"
                  value:
                    id: "holiday-uuid-1"
                    isSoftDeleted: true
                    isHardDeleted: false

  # ==========================================
  # 2. Security Levels (복원 및 순서 조정)
  # ==========================================
  /operator-levels:
    get:
      tags: ["2. Security Levels"]
      summary: "운영자 등급(Operator Level) 목록 조회"
      description: |
        사람(Personnel)에게 부여할 수 있는 보안 등급 목록을 조회합니다.<br>
        `accessLevel`이 높을수록 더 높은 보안 등급의 문을 통과할 수 있습니다.<br>
        `antipassbackLevel`이 높을수록 더 높은 안티패스백 면제 등급을 가질 수 있습니다.<br>
        `armingLevel`이 높을수록 더 높은 경비 등급을 가질 수 있습니다.<br>
      parameters:
        - name: "organizationId"
          in: "query"
          description: "조직 ID"
          schema:
            type: "string"
            format: "uuid"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/OperatorLevel"
                  page:
                    $ref: "#/components/schemas/PageMetadata"
    post:
      tags: ["2. Security Levels"]
      summary: "운영자 등급 생성"
      description: |
        새로운 운영자 등급을 생성합니다.
        `accessLevel`, `antipassbackLevel`, `armingLevel`은 모두 정수형(Integer)입니다.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OperatorLevelRequest"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OperatorLevel"

  /operator-levels/{id}:
    get:
      tags: ["2. Security Levels"]
      summary: "운영자 등급 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OperatorLevel"
    put:
      tags: ["2. Security Levels"]
      summary: "운영자 등급 수정"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OperatorLevelRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OperatorLevel"
    delete:
      tags: ["2. Security Levels"]
      summary: "운영자 등급 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

  /access-thresholds:
    get:
      tags: ["2. Security Levels"]
      summary: "출입 임계값(Access Threshold) 목록 조회"
      description: |
        출입문(Access Point)에 설정할 수 있는 최소 보안 요구사항 목록을 조회합니다.<br>
        `minAccessLevel`보다 낮은 `accessLevel`을 가진 사람은 출입이 거부됩니다.
      parameters:
        - name: "organizationId"
          in: "query"
          schema:
            type: "string"
            format: "uuid"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/AccessThreshold"
                  page:
                    $ref: "#/components/schemas/PageMetadata"
    post:
      tags: ["2. Security Levels"]
      summary: "출입 임계값 생성"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AccessThresholdRequest"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessThreshold"

  /access-thresholds/{id}:
    get:
      tags: ["2. Security Levels"]
      summary: "출입 임계값 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessThreshold"
    put:
      tags: ["2. Security Levels"]
      summary: "출입 임계값 수정"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AccessThresholdRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessThreshold"
    delete:
      tags: ["2. Security Levels"]
      summary: "출입 임계값 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

  # ==========================================
  # 3. Access Point Management
  # ==========================================
  /access-points:
    get:
      tags: ["3. Access Point Management"]
      summary: "출입 지점(Access Point) 목록 조회"
      description: |
        물리적 출입 지점 목록을 조회합니다.<br>
        상위 공간(`site`, `facility`, `sector`) 및 구역(`area`)별 조회나 타입(`type`)별 필터링을 지원합니다.
      parameters:
        - name: "organizationId"
          in: "query"
          schema:
            type: "string"
            format: "uuid"
        - name: "siteId"
          in: "query"
          description: "소속 사이트 ID 필터"
          schema:
            type: "string"
            format: "uuid"
        - name: "facilityId"
          in: "query"
          description: "소속 시설물(건물) ID 필터"
          schema:
            type: "string"
            format: "uuid"
        - name: "sectorId"
          in: "query"
          description: "소속 구획(층) ID 필터"
          schema:
            type: "string"
            format: "uuid"
        - name: "areaId"
          in: "query"
          description: "소속 구역 ID 필터"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "출입 지점명 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "type"
          in: "query"
          description: "출입 지점 타입 필터"
          schema:
            type: "string"
            enum: ["DOOR", "GATE_DOOR", "TURNSTILE", "ELEVATOR", "SPEED_GATE", "BARRIER", "SLIDING", "SHUTTER", "BOLLARD"]
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
        - name: "sort"
          in: "query"
          description: |
            정렬 기준 (형식: 필드명,정렬방향)<br>
            예: name,asc (이름순), createdAt,desc (최신순)<br>
            다중 정렬 가능
          schema:
            type: "array"
            items:
              type: "string"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/AccessPoint"
                  page:
                    $ref: "#/components/schemas/PageMetadata"
    post:
      tags: ["3. Access Point Management"]
      summary: "출입 지점 생성"
      description: |
        새로운 물리적 출입 지점을 생성합니다.
        
        **주요 필드:**
        - `areaId`: 소속 구역 (필수)
        - `fromAreaId`, `toAreaId`: 안티패스백을 위한 진입/진출 구역 정보
        - `accessPointType`: 장비 제어 로직을 결정하는 타입 (기본값 DOOR)
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AccessPointRequest"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessPoint"

  /access-points/types:
    get:
      tags: ["3. Access Point Management"]
      summary: "출입 지점 타입 목록 조회"
      description: |
        시스템에서 지원하는 출입 지점 타입(Enum) 목록을 조회합니다.<br>
        출입 지점 타입(Enum) 목록:<br>
        `"DOOR", "GATE_DOOR", "TURNSTILE", "ELEVATOR", "SPEED_GATE", "BARRIER", "SLIDING", "SHUTTER", "BOLLARD"`<br>
        UI 드롭다운(Select Box) 구성에 사용됩니다.<br>
        반환 예시: <br>
        `[{ "code": "DOOR", "label": "일반 출입문" }, { "code": "TURNSTILE", "label": "스피드 게이트" }]`
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "array"
                items:
                  $ref: "#/components/schemas/AccessPointType"  

  /access-points/{id}:
    get:
      tags: ["3. Access Point Management"]
      summary: "출입 지점 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessPoint"
    put:
      tags: ["3. Access Point Management"]
      summary: "출입 지점 수정"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AccessPointRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessPoint"
    delete:
      tags: ["3. Access Point Management"]
      summary: "출입 지점 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

  /access-point-configs/{accessPointId}:
    get:
      tags: ["3. Access Point Management"]
      summary: "출입문 보안 설정 조회"
      description: |
        특정 출입문(Access Point)에 설정된 보안 정책을 조회합니다.
        Space Service에 등록된 물리적 `accessPointId`를 Key로 사용합니다.
      parameters:
        - name: "accessPointId"
          in: "path"
          required: true
          description: "Space Service의 Access Point ID"
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessPointConfig"
        '404':
          description: "Not Found. 해당 출입문에 대한 설정이 없습니다."
          
    put:
      tags: ["3. Access Point Management"]
      summary: "출입문 보안 설정 수정/등록 (Upsert)"
      description: |
        특정 출입문에 대한 보안 정책을 설정합니다.<br>
        이미 설정이 존재하면 수정하고, 없으면 새로 생성합니다 (Upsert 방식).<br>
        
        - **입실(Entry) / 퇴실(Exit) 정책 분리:** 들어올 때와 나갈 때의 규칙을 다르게 설정할 수 있습니다.
        - **참조 ID:** `AuthenticationRule`과 `AccessThreshold`의 ID를 연결합니다. (ID 유효성 검증 필요)
      parameters:
        - name: "accessPointId"
          in: "path"
          required: true
          description: "Space Service의 Access Point ID"
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AccessPointConfigRequest"
      responses:
        '200':
          description: "설정 저장 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessPointConfig"

  /access-groups:
    get:
      tags: ["3. Access Point Management"]
      summary: "출입 포인트 그룹 목록 조회"
      description: |
        출입 포인트 그룹 목록을 조회합니다.<br>
        그룹은 권한 할당의 편의를 위해 여러 출입 포인트를 묶어서 관리하는 단위입니다.
      parameters:
        - name: "organizationId"
          in: "query"
          schema:
            type: "string"
            format: "uuid"
        - name: "name"
          in: "query"
          description: "그룹 이름 검색 (부분 일치)"
          schema:
            type: "string"
        - name: "isActive"
          in: "query"
          schema:
            type: "boolean"
        - name: "page"
          in: "query"
          schema:
            type: "integer"
            default: 0
        - name: "size"
          in: "query"
          schema:
            type: "integer"
            default: 1000
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  content:
                    type: "array"
                    items:
                      $ref: "#/components/schemas/AccessGroup"
                  page:
                    $ref: "#/components/schemas/PageMetadata"
    post:
      tags: ["3. Access Point Management"]
      summary: "출입 포인트 그룹 생성"
      description: |
        새로운 출입 포인트 그룹을 생성합니다.<br>
        `accessPointIds` 목록을 포함하여 그룹에 속할 출입 포인트를 한 번에 지정할 수 있습니다.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AccessGroupRequest"
      responses:
        '200':
          description: "생성됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessGroup"

  /access-groups/{id}:
    get:
      tags: ["3. Access Point Management"]
      summary: "출입 포인트 그룹 단건 조회"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessGroup"
    put:
      tags: ["3. Access Point Management"]
      summary: "출입 포인트 그룹 수정"
      description: |
        출입 포인트 그룹 정보를 전체 수정합니다.<br>
        `accessPointIds` 목록을 새로 전달하면, 기존 매핑은 제거되고 새로운 목록으로 교체됩니다.
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AccessGroupRequest"
      responses:
        '200':
          description: "수정됨"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessGroup"
    delete:
      tags: ["3. Access Point Management"]
      summary: "출입 포인트 그룹 삭제"
      parameters:
        - name: "id"
          in: "path"
          required: true
          schema:
            type: "string"
            format: "uuid"
      responses:
        '200':
          description: "삭제 성공"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeleteResult"

components:
  schemas:
    # ----------------------------------------------------
    # Common Schemas
    # ----------------------------------------------------
    PageMetadata:
      type: "object"
      properties:
        size:
          type: "integer"
          description: "페이지 당 항목 수"
          example: 20
        page:
          type: "integer"
          description: "현재 페이지 번호 (0부터 시작)"
          example: 0
        totalElements:
          type: "integer"
          description: "전체 항목 수"
          example: 100
        totalPages:
          type: "integer"
          description: "전체 페이지 수"
          example: 5
        isLast:
          type: "boolean"
          description: "마지막 페이지 여부"
          example: false
        hasNext:
          type: "boolean"
          description: "다음 페이지 존재 여부"
          example: true

    DeleteResult:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
          description: "삭제된 리소스의 ID"
        isSoftDeleted:
          type: "boolean"
          description: "논리적 삭제(Soft Delete) 여부. true면 DB에는 남아있지만 삭제된 것으로 처리됨."
        isHardDeleted:
          type: "boolean"
          description: "물리적 삭제(Hard Delete) 여부. true면 DB에서 완전히 제거됨."

    # ----------------------------------------------------
    # 1. Time Policies
    # ----------------------------------------------------
    TimeScheduleListResponse:
      type: "object"
      properties:
        content:
          type: "array"
          items:
            $ref: "#/components/schemas/TimeSchedule"
        page:
          $ref: "#/components/schemas/PageMetadata"

    TimeSchedule:
      type: "object"
      properties:
        organizationId:
          type: "string"
          format: "uuid"
        id:
          type: "string"
          format: "uuid"
        name:
          type: "string"
          example: "평일 근무시간"
        description:
          type: "string"
        code:
          type: "string"
        details:
          type: "array"
          description: "항상 모든 요일(MON~SUN)과 설정된 공휴일 타입의 상세 설정이 포함됩니다."
          items:
            $ref: "#/components/schemas/TimeScheduleDetail"
        isActive:
          type: "boolean"
        createdAt:
          type: "string"
          format: "date-time"
        updatedAt:
          type: "string"
          format: "date-time"

    TimeSlot:
      type: "object"
      properties:
        startTime:
          type: "string"
          description: "HH:mm:ss 형식"
          example: "09:00:00"
        endTime:
          type: "string"
          description: "HH:mm:ss 형식"
          example: "12:00:00"

    TimeScheduleDetail:
      type: "object"
      properties:
        dayOfWeek:
          type: "string"
          description: "요일 코드 (MON, TUE... SUN) 또는 공휴일 스케쥴 타입 (예: HOL1, HOL2...)"
          example: "MON"
        type:
          type: "string"
          description: "스케쥴 유형"
          enum: ["CUSTOM", "ALWAYS_ALLOWED", "ALWAYS_DENIED"]
        holiday:
          $ref: "#/components/schemas/HolidayReference"
          description: "dayOfWeek이 공휴일 타입(HOL...)인 경우 포함되는 공휴일 상세 정보"
        timeSlots:
          type: "array"
          description: "시간 구간 목록 (type가 'CUSTOM'일 때 필수)"
          items:
            $ref: "#/components/schemas/TimeSlot"
          nullable: true

    TimeScheduleDetailRequest:
      type: "object"
      required: ["dayOfWeek", "type"]
      properties:
        dayOfWeek:
          type: "string"
          description: "요일 코드 (MON, TUE... SUN) 또는 공휴일 스케쥴 타입 (예: HOL1, HOL2...)"
          example: "MON"
        type:
          type: "string"
          description: "스케쥴 유형"
          enum: ["CUSTOM", "ALWAYS_ALLOWED", "ALWAYS_DENIED"]
        holidayId:
          type: "string"
          format: "uuid"
          description: "dayOfWeek이 공휴일 타입(HOL...)인 경우 매핑할 공휴일 ID"
        timeSlots:
          type: "array"
          description: "시간 구간 목록 (type가 'CUSTOM'일 때 필수)"
          items:
            $ref: "#/components/schemas/TimeSlot"
          nullable: true

    TimeScheduleRequest:
      type: "object"
      required: ["name", "details"]
      properties:
        organizationId:
          type: "string"
          format: "uuid"
        name:
          type: "string"
        description:
          type: "string"
        code:
          type: "string"
        details:
          type: "array"
          description: "모든 요일(MON~SUN)과 필요한 공휴일 타입(HOL...)에 대한 상세 설정 (최소 7개 필수)"
          minItems: 7
          items:
            $ref: "#/components/schemas/TimeScheduleDetailRequest"
        isActive:
          type: "boolean"
          default: true

    HolidayListResponse:
      type: "object"
      properties:
        content:
          type: "array"
          items:
            $ref: "#/components/schemas/Holiday"
        page:
          $ref: "#/components/schemas/PageMetadata"

    HolidayReference:
      type: "object"
      description: "스케쥴 응답 시 포함되는 공휴일 요약 정보"
      properties:
        id:
          type: "string"
          format: "uuid"
        name:
          type: "string"
          example: "설날 연휴"
        dates:
          type: "array"
          description: "해당 공휴일에 포함된 모든 날짜 목록"
          items:
            type: "string"
            format: "date"
            example: "2024-02-10"

    Holiday:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
        name:
          type: "string"
        description:
          type: "string"
        code:
          type: "string"
        isRecurring:
          type: "boolean"
        items:
          type: "array"
          description: "공휴일에 포함된 날짜 목록"
          items:
            $ref: "#/components/schemas/HolidayItem"
        isActive:
          type: "boolean"

    HolidayItem:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
        holidayDate:
          type: "string"
          description: "YYYY-MM-DD (isRecurring=false) 또는 MM-DD (isRecurring=true)"
          example: "2024-01-01"
        isSubstitute:
          type: "boolean"

    HolidayRequest:
      type: "object"
      required: ["name", "items"]
      properties:
        organizationId:
          type: "string"
          format: "uuid"
        name:
          type: "string"
        description:
          type: "string"
        code:
          type: "string"
        isRecurring:
          type: "boolean"
          default: false
        items:
          type: "array"
          minItems: 1
          items:
            type: "object"
            required: ["holidayDate"]
            properties:
              holidayDate:
                type: "string"
                # YYYY-MM-DD 또는 MM-DD 형식을 모두 허용하는 정규식
                pattern: "^(\\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01])|(0[1-9]|1[0-2])-(0[1-9]|[12]\\d|3[01]))$"
                description: "날짜. isRecurring=true면 'MM-DD', false면 'YYYY-MM-DD' 형식"
                example: "01-01"
              isSubstitute:
                type: "boolean"
                default: false
        isActive:
          type: "boolean"
          default: true

    # ----------------------------------------------------
    # 2. Security Levels
    # ----------------------------------------------------
    OperatorLevel:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
        name:
          type: "string"
          example: "일반 임직원"
        description:
          type: "string"
        accessLevel:
          type: "integer"
          description: "출입 권한 레벨 (0~255). 이 값이 문의 minAccessLevel보다 크거나 같아야 통과."
          example: 10
        antipassbackLevel:
          type: "integer"
          description: "안티패스백 면제 레벨"
          example: 1
        armingLevel:
          type: "integer"
          description: "경비(Arming) 설정 가능 레벨"
          example: 1
        isActive:
          type: "boolean"

    OperatorLevelRequest:
      type: "object"
      required: ["name", "accessLevel", "antipassbackLevel", "armingLevel"]
      properties:
        organizationId:
          type: "string"
          format: "uuid"
        name:
          type: "string"
        description:
          type: "string"
        accessLevel:
          type: "integer"
          minimum: 0
          maximum: 255
        antipassbackLevel:
          type: "integer"
          minimum: 0
          maximum: 255
        armingLevel:
          type: "integer"
          minimum: 0
          maximum: 255
        isActive:
          type: "boolean"
          default: true

    AccessThreshold:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
        name:
          type: "string"
          example: "보안구역 레벨"
        description:
          type: "string"
        minAccessLevel:
          type: "integer"
          description: "최소 요구 출입 레벨"
          example: 10
        minAntipassbackLevel:
          type: "integer"
          description: "최소 요구 안티패스백 면제 레벨"
          example: 5
        minArmingLevel:
          type: "integer"
          description: "최소 요구 경비 레벨"
          example: 10
        isActive:
          type: "boolean"

    AccessThresholdRequest:
      type: "object"
      required: ["name", "minAccessLevel", "minAntipassbackLevel", "minArmingLevel"]
      properties:
        organizationId:
          type: "string"
          format: "uuid"
        name:
          type: "string"
        description:
          type: "string"
        minAccessLevel:
          type: "integer"
          minimum: 0
          maximum: 255
        minAntipassbackLevel:
          type: "integer"
          minimum: 0
          maximum: 255
        minArmingLevel:
          type: "integer"
          minimum: 0
          maximum: 255
        isActive:
          type: "boolean"
          default: true

    # ----------------------------------------------------
    # 3. Access Point Management
    # ----------------------------------------------------
    AccessPointType:
      type: "object"
      properties:
        code:
          type: "string"
          description: "타입 코드 (DB 저장 값)"
          example: "DOOR"
        label:
          type: "string"
          description: "화면 표시용 라벨"
          example: "일반 출입문"

    AccessPoint:
      type: "object"
      properties:
        organizationId:
          type: "string"
          format: "uuid"
        siteId:
          type: "string"
          format: "uuid"
          description: "소속 사이트 ID"
        facilityId:
          type: "string"
          format: "uuid"
          description: "소속 시설물 ID"
        sectorId:
          type: "string"
          format: "uuid"
          description: "소속 구획 ID"
        areaId:
          type: "string"
          format: "uuid"
          description: "소속 구역 ID"
        id:
          type: "string"
          format: "uuid"
        siteName:
          type: "string"
          description: "소속 사이트명 (예: 판교 캠퍼스)"
        facilityName:
          type: "string"
          description: "소속 시설물명 (예: 본관)"
        sectorName:
          type: "string"
          description: "소속 구획명 (예: 1F)"
        areaName:
          type: "string"
          description: "소속 구역명 (예: 로비)"
        name:
          type: "string"
          example: "본관 1층 정문"
        description:
          type: "string"
        code:
          type: "string"
        type:
          type: "string"
          enum: ["DOOR", "GATE_DOOR", "TURNSTILE", "ELEVATOR", "SPEED_GATE", "BARRIER", "SLIDING", "SHUTTER", "BOLLARD"]
        fromAreaId:
          type: "string"
          format: "uuid"
          description: "진입 전 구역 ID (안티패스백용)"
        toAreaId:
          type: "string"
          format: "uuid"
          description: "진입 후 구역 ID (안티패스백용)"
        config:
          type: "object"
          description: "하드웨어 제어 관련 설정 (개방 시간, 릴레이 등)"
        isActive:
          type: "boolean"
        createdAt:
          type: "string"
          format: "date-time"
        updatedAt:
          type: "string"
          format: "date-time"

    AccessPointRequest:
      type: "object"
      required: ["name", "areaId", "accessPointType"]
      properties:
        organizationId:
          type: "string"
          format: "uuid"
        areaId:
          type: "string"
          format: "uuid"
        name:
          type: "string"
        description:
          type: "string"
        accessPointCode:
          type: "string"
        accessPointType:
          type: "string"
          enum: ["DOOR", "GATE_DOOR", "TURNSTILE", "ELEVATOR", "SPEED_GATE", "BARRIER", "SLIDING", "SHUTTER", "BOLLARD"]
          default: "DOOR"
        fromAreaId:
          type: "string"
          format: "uuid"
          nullable: true
        toAreaId:
          type: "string"
          format: "uuid"
          nullable: true
        config:
          type: "object"
          nullable: true
        isActive:
          type: "boolean"
          default: true

    AccessPointConfig:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
        accessPointId:
          type: "string"
          format: "uuid"
          description: "Space Service의 Access Point ID"
        entryAccessThresholdId:
          type: "string"
          format: "uuid"
          description: "입실 시 요구되는 최소 보안 임계값 ID"
          nullable: true
        entryAuthenticationRuleId:
          type: "string"
          format: "uuid"
          description: "입실 시 적용할 인증 규칙 ID"
          nullable: true
        exitAccessThresholdId:
          type: "string"
          format: "uuid"
          description: "퇴실 시 요구되는 최소 보안 임계값 ID"
          nullable: true
        exitAuthenticationRuleId:
          type: "string"
          format: "uuid"
          description: "퇴실 시 적용할 인증 규칙 ID"
          nullable: true
        isActive:
          type: "boolean"
        createdAt:
          type: "string"
          format: "date-time"
        updatedAt:
          type: "string"
          format: "date-time"

    AccessPointConfigRequest:
      type: "object"
      properties:
        entryAccessThresholdId:
          type: "string"
          format: "uuid"
          description: "입실 시 요구되는 최소 보안 임계값 ID"
          nullable: true
        entryAuthenticationRuleId:
          type: "string"
          format: "uuid"
          description: "입실 시 적용할 인증 규칙 ID"
          nullable: true
        exitAccessThresholdId:
          type: "string"
          format: "uuid"
          description: "퇴실 시 요구되는 최소 보안 임계값 ID"
          nullable: true
        exitAuthenticationRuleId:
          type: "string"
          format: "uuid"
          description: "퇴실 시 적용할 인증 규칙 ID"
          nullable: true
        isActive:
          type: "boolean"
          default: true

    AccessGroup:
      type: "object"
      properties:
        id:
          type: "string"
          format: "uuid"
        organizationId:
          type: "string"
          format: "uuid"
        name:
          type: "string"
          example: "1층 전체 출입문"
        description:
          type: "string"
        accessPointIds:
          type: "array"
          description: "그룹에 포함된 출입 포인트 ID 목록"
          items:
            type: "string"
            format: "uuid"
        isActive:
          type: "boolean"
        createdAt:
          type: "string"
          format: "date-time"
        updatedAt:
          type: "string"
          format: "date-time"

    AccessGroupRequest:
      type: "object"
      required: ["name"]
      properties:
        organizationId:
          type: "string"
          format: "uuid"
        name:
          type: "string"
        description:
          type: "string"
        accessPointIds:
          type: "array"
          description: "그룹에 포함시킬 출입 포인트 ID 목록"
          items:
            type: "string"
            format: "uuid"
        isActive:
          type: "boolean"
          default: true

    